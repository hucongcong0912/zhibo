dwfis.define("widget/backtotop",function(require,exports,module){var backtotop={init:function(){this.render()},render:function(){var _tpl=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="hy-side" id="J_hySide">\r\n    <div class="hy-side-nav">\r\n        <div class="hy-side-nav-item hover-download">\r\n            <a class="clickstat" target="_blank" href="//www.huya.com/download/" eid="click/navi/right/download" eid_desc="\u70b9\u51fb/\u5bfc\u822a/\u53f3\u4fa7/\u4e0b\u8f7d">\r\n                <i class="hy-side-nav-phone"></i>\r\n                <p class="hy-side-nav-txt">\u4e0b\u8f7d</p>\r\n            </a>\r\n            <div class="hy-side-nav-download">\r\n                <a class="clickstat side-nav-download1" target="_blank" href="//www.huya.com/download/" eid="click/navi/right/download" eid_desc="\u70b9\u51fb/\u5bfc\u822a/\u53f3\u4fa7/\u4e0b\u8f7d">\u4e0b\u8f7dAPP</a>\r\n                <a class="clickstat side-nav-download2" target="_blank" href="//www.huya.com/download/#tv" eid="click/navi/right/download" eid_desc="\u70b9\u51fb/\u5bfc\u822a/\u53f3\u4fa7/\u4e0b\u8f7d">\u4e0b\u8f7dTV\u7248</a>\r\n            </div>\r\n        </div>\r\n        <a class="hy-side-nav-item clickstat" target="_blank" href="//www.huya.com/e/zhubo" eid="click/navi/right/shower" eid_desc="\u70b9\u51fb/\u5bfc\u822a/\u53f3\u4fa7/\u6211\u8981\u76f4\u64ad">\r\n            <i class="hy-side-nav-video"></i>\r\n            <p class="hy-side-nav-txt">\u5f00\u64ad</p>\r\n        </a>\r\n        <a class="hy-side-nav-item clickstat" target="_blank" href="//www.huya.com/act/coperation/" eid="click/navi/right/hezuo" eid_desc="\u70b9\u51fb/\u5bfc\u822a/\u53f3\u4fa7/\u5408\u4f5c">\r\n            <i class="hy-side-nav-cope"></i>\r\n            <p class="hy-side-nav-txt">\u5408\u4f5c</p>\r\n        </a>\r\n        <a class="hy-side-nav-item clickstat" target="_blank" href="http://blog.huya.com/product/81" eid="click/navi/right/kefu" eid_desc="\u70b9\u51fb/\u5bfc\u822a/\u53f3\u4fa7/\u5ba2\u670d">\r\n            <i class="hy-side-nav-qa"></i>\r\n            <p class="hy-side-nav-txt">\u53cd\u9988</p>\r\n        </a>\r\n        <a class="hy-side-nav-item clickstat" target="_blank" href="http://help.huya.com" eid="click/navi/right/help" eid_desc="\u70b9\u51fb/\u5bfc\u822a/\u53f3\u4fa7/\u5e2e\u52a9">\r\n            <i class="hy-side-nav-help"></i>\r\n            <p class="hy-side-nav-txt">\u5e2e\u52a9</p>\r\n        </a>\r\n        <a class="hy-side-nav-item" id="J_hyBackToTop" style="display:none;" href="#">\r\n            <i class="hy-side-nav-top"></i>\r\n            <p class="hy-side-nav-txt">\u9876\u90e8</p>\r\n        </a>\r\n    </div>\r\n</div>';return __p};$("body").append(_tpl());var _timeout=null,$navBackTop=$("#J_hyBackToTop"),$win=$(".js-responded-list");0==$win.length&&($win=$(window)),$win.on("scroll",function(){clearTimeout(_timeout),_timeout=setTimeout(function(){$win.scrollTop()>200?$navBackTop.show():$navBackTop.hide()},60)}),$navBackTop.click(function(a){a.preventDefault(),$win[0]===window?$("html,body").animate({scrollTop:0},500):$win.animate({scrollTop:0},500)})}};backtotop.init()});
;dwfis.define("tools",function(n,e){{var t=e.once=function(n){var e,t;return function(){return t||(t=!0,e=n.apply(this,arguments)),e}},o=(e.getSingle=function(n){var e;return function(){return e||(e=n.apply(this,arguments))}},e.lazyPromise=function(n){var e=t(function(){var e=new $.Deferred;return n(function(){e.resolveWith(this,arguments)},function(){e.rejectWith(this,arguments)}),function(n,t){return e.done(n).fail(t).promise()}});return function(n,t){return e()(n,t)}}),r=e.getScript=function(n,e,t){function o(){r(),"function"==typeof e&&e()}function r(){c.onload=c.onreadystatechange=c.onerror=null,c=null}var a=document,u=a.head||a.getElementsByTagName("head")[0]||a.documentElement,c=a.createElement("script");"onload"in c?c.onload=o:c.onreadystatechange=function(){/loaded|complete/.test(c.readyState)&&o()},"onerror"in c&&(c.onerror=function(){r(),"function"==typeof t&&t()}),c.charset="utf-8",c.type="text/javascript",c.async=!0,c.src=n,u.appendChild(c)},a=(e.lazyLoadScript=function(n){return o(function(e,t){r(n,e,t)})},e.jsonp=function(n){n=$.extend({url:"",data:{},jsonpCallback:"callback",cache:!1},n);var e=$.extend({},n.data),t=e[n.jsonpCallback]="jsonp_callback_"+Math.floor(1e10*Math.random());n.cache||(e._=Math.floor(1e10*Math.random()));var o=$.Deferred();window[t]=function(n){window[t]=null,o.resolve(n)};var a=n.url+(-1==n.url.indexOf("?")?"?":"&")+$.param(e);return r(a,function(){},function(){o.reject()}),o.promise()},e.debounce=function(n,e,t){var o=null,r=function(){o&&clearTimeout(o);var r=this,a=arguments;return t?(o||n.apply(r,a),o=setTimeout(function(){o=null},e)):o=setTimeout(function(){o=null,n.apply(r,a)},e),r};return r.cancel=function(){clearTimeout(o),o=null},r});e.throttle=function(n,e){function t(){a=arguments,u=this,r||(r=setTimeout(function(){r=null,n.apply(u,a),u=a=null},o?0:e),o&&(o=!1))}var o=!0,r=null,a=null,u=null;return t.cancel=function(){clearTimeout(r),r=u=a=null},t},e.loadImg=function(n,e,t,o){return n?(e=e||function(){},t=t||function(){},o=o||new Image,o.readyState?o.onreadystatechange=function(){/loaded|complete/.test(o.readyState)&&(o.onreadystatechange=null,e(o))}:o.onload=function(){e(o)},o.onerror=function(){t(o)},o.src=n,o):void 0},e.DJBHash=function(n){if(n){var e,n=n+"",t=5381;if(n){for(var o=0,r=n.length;r>o;++o)t+=(t<<5)+n.charAt(o).charCodeAt();e=2147483647&t}return e}},e.importStyle=function(n,e){if(!document.getElementById(e)){var t=document.createElement("style");if(e&&(t.id=e),document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet){if(document.getElementsByTagName("style").length>31)throw new Error("Exceed the maximal count of style tags in IE");t.styleSheet.cssText+=n}else t.appendChild(document.createTextNode(n));return t}},e.exposure=function(n,e,t){if(n){n=$(n),e="function"==typeof e?e:function(){},t=t||0;var o,r=$(window),u=a(function(){o=o||n.offset(),o.top<=r.scrollTop()+r.height()+t&&(r.off("scroll",u),e(n))},60);r.on("scroll",u),u()}}}e.toRgb=function(n){var e="",t="";return $.isNumeric(n)&&(n=parseInt(n,10),n>=0&&(t=n.toString(16),e=("000000"+t).slice(t.length))),e},e.format=function(n){return $.isNumeric(n)?(n+"").replace(/(\d)(?=(\d{3})+$)/g,"$1,"):n}});
;dwfis.define("exposureReport",function(t,i,e){function o(){this.initialize()}o.prototype={initialize:function(){{var t=this;$(window)}this.limited=20,this.aData=[],this.route="",this.onload=!1,window.TT&&TT.on("reportReady",function(){t._exposure()},!0)},reportData:function(t,i){this.route!==i?(this.aData=[].concat(t.slice(0,t.length)),this.route=i):this.aData=this.aData.concat(t.slice(0,t.length)),this._exposure()},_exposure:function(){if(!window.ya)return!1;for(;this.aData.length>0;){var t=this.aData.splice(0,this.limited),i=[],e="";$.each(t,function(t,e){i.push(e.uid||e.lUid||0)}),e="uidlist:["+i.join(",")+"]";try{ya.reportProductEvent({traceid:0,eid:"pageview/position",position:this.route,extra:e})}catch(o){}}}},e.exports=o});
;dwfis.define("widget/index-game-classify/video-preview.js",function(e){function n(){}var i=e("exposureReport"),t=new i;return n.prototype={isSupported:function(){return/webkit/gi.test(navigator.userAgent)&&document.createElement("video").canPlayType?!0:!1},playerHandle:function(e){var n=this.H5Player,i=e.container,t=e.item,r=new n;r.setLogLevel(2),r.setVolume(0),r.on(n.Events.VIDEO_PLAY,function(e,n){if(!n.haveVideo)return!1;var t=$('<div class="h5video"></div>'),r=n.video;r.autoplay=!0,r.defaultMuted=!0,t.append(r),i.find(".h5video").remove(),i.find(".img-box").append(t)}),r.on(n.Events.VIDEO_STOP,function(){i.find(".h5video").remove()});var a=!0;r.startHls(t.previewUrl,a)},loadH5playerSDK:function(n){var i=this;return this.H5Player?(n&&n(),!1):void e.async("h5player",function(e){return e.isSupported()?(i.H5Player=e,void(n&&n())):!1})}},window.rec4x4Data?(function(){for(var e=[],n=0,i=rec4x4Data.length;i>n;n++){var r=rec4x4Data[n].contents;r&&r.length>0&&(e=e.concat(r))}t.reportData(e,"index/remen"),$.each(e,function(e,n){TT_RSC_EXPS({pos:"index/remen/"+e,ren:n.uid})})}(),void TT.on("h5VideoloadTime",function(){function e(){var e=$(".game-classify");$.each(rec4x4Data.slice(0,4),function(n,t){t&&$.isArray(t.contents)&&$.each(t.contents.slice(0,4),function(t,r){if(!r.previewUrl)return!1;var a=e.eq(n).find("li").eq(t).find("a");i.playerHandle({container:a,item:r})})})}var i=new n;return i.isSupported()?void i.loadH5playerSDK(e):!1})):!1});
;dwfis.define("widget/index-program-preview",function(require,exports,module){function AssignSub(){this.initialize.apply(this,arguments),this._bindEvent()}function CancelSub(){this.initialize.apply(this,arguments)}function Newspaper(){this.initialize.apply(this,arguments)}function triggerLazyload(){$win.scrollTop()>=500&&($jsPreviewBox.find("img").trigger("appear"),new Newspaper({elementId:"#js-preview-box"}),$win.off(".js-preview-box"))}AssignSub.prototype={initialize:function(e){this.parentSub=e,this.previewDialogLayer=null},btnStatus:function(e){e.addClass("isOrder").removeClass("normal"),e.find(".preview-btn-text").text("\u5df2\u9884\u8ba2"),e.find(".preview-btn").attr({title:"\u70b9\u51fb\u53d6\u6d88\u9884\u8ba2",eid:"click/program/cancel",eid_desc:"\u70b9\u51fb/\u8282\u76ee/\u53d6\u6d88\u9884\u7ea6"})},change:function(eid,$btn){function changeCallback(){var _this=this,$li=$btn.parents(".preview-item"),previewDialogTmpl=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="preview-dialog-box">\r\n    <div class="preview-dialog-hd">\r\n        <span class="preview-dialog-title">\u63d0\u793a</span>\r\n        <a class="preview-dialog-close" title="\u5173\u95ed\u5f39\u7a97"></a>\r\n    </div>\r\n    <div class="preview-dialog-bd">\r\n        <div class="preview-dialog-pic">\r\n            <img src="images/QR_code.png" alt="\u864e\u7259\u4e8c\u7ef4\u7801">\r\n        </div>\r\n        <div class="preview-dialog-text">\r\n            <div class="preview-dialog-status"><i class="preview-dialog-status-icon"></i>\u9884\u8ba2\u6210\u529f</div>\r\n            <p class="preview-dialog-content">\r\n                \u626b\u63cf\u4e8c\u7ef4\u7801\u5b89\u88c5\u864e\u7259APP\uff0c\r\n                \u76f4\u64ad\u5f00\u59cb\u5373\u53ef\u7b2c\u4e00\u65f6\u95f4\u6536\u5230\u9884\u7ea6\u63d0\u9192\u5594\uff01\r\n            </p>\r\n        </div>\r\n    </div>\r\n</div>';return __p};this.previewDialogLayer?this.previewDialogLayer.open():require.async("dialog",function(e){_this.previewDialogLayer=e.layer({view:previewDialogTmpl(),zIndex:10001})}),this.btnStatus($li)}var _this=this;this.parentSub.getData(this.parentSub.ajaxObj.subscribeUrl,{eid:eid,subscribe:1,uid:this.parentSub.yyUid},function(e){0==e.status&&changeCallback.call(_this)})},_bindEvent:function(){var e=this;$(document).on("click.preview-dialog",".preview-dialog-close",function(){e.previewDialogLayer.hide()})},destroy:function(){$(document).off("click.preview-dialog")}},CancelSub.prototype={initialize:function(e){this.parentSub=e},btnStatus:function(e){e.removeClass("isOrder").addClass("normal"),e.find(".preview-btn-text").text("\u9884\u8ba2"),e.find(".preview-btn").attr({title:"\u70b9\u51fb\u9884\u8ba2",eid:"click/program/book",eid_desc:"\u70b9\u51fb/\u8282\u76ee/\u9884\u7ea6"})},change:function(e,i){function t(){var e=i.parents(".preview-item"),t=$('<i class="prview-cancel-tip">\u5df2\u53d6\u6d88</i>').appendTo(i),n=setTimeout(function(){t.animate({opacity:0},function(){t.remove(),clearTimeout(n)})},1e3);this.btnStatus(e)}var n=this;this.parentSub.getData(this.parentSub.ajaxObj.subscribeUrl,{eid:e,subscribe:0,uid:this.parentSub.yyUid},function(e){0==e.status&&t.call(n)})}},Newspaper.prototype={initialize:function(e){this.yyUid=window.HUYA_UTIL&&HUYA_UTIL.getCookieVal("yyuid")||0;var i=this;if(this.ajaxObj={stateUrl:"//upevent.huya.com/getSubscribeState",subscribeUrl:TT.app.main+"member/index.php?m=Upcoming&do=subscribe"},this.$elementId=$(e.elementId),$.isFunction($.fn.jScrollPane))this.jScrollPaneElement=$(".preview-wrap").jScrollPane({mouseWheelSpeed:20,verticalGutter:0,isOutsideNotPrevent:!1});else{var t="//a.msstatic.com/huya/main/lib/scrollpane_51f7a10.js";$.ajax(t,{dataType:"script",cache:!0,success:function(){i.jScrollPaneElement=$(".preview-wrap").jScrollPane({mouseWheelSpeed:20,verticalGutter:0,isOutsideNotPrevent:!1})}})}this.assignSub=new AssignSub(this),this.cancelSub=new CancelSub(this),this.getSubscribeState(),this.bindEvent(),window.DUYA_SUB&&DUYA_SUB.subscribe("INDEX_LIVE_NOTICE",this.setLiveState)},setLiveState:function(e,i){var t=$('[data-event-id="'+i+'"]'),n=t.data("url");t.hasClass("isLive")||(t.removeClass("normal isOrder").addClass("isLive"),t.find("a").attr({href:n,target:"_blank"}),t.find(".preview-time").text("\u6b63\u5728\u76f4\u64ad"),t.find(".preview-btn-text").text("\u770b\u76f4\u64ad"),t.find(".preview-btn").attr({title:"",eid:"click/program/"+i,eid_desc:"\u70b9\u51fb/\u8282\u76ee/\u8282\u76ee"+i}))},getSubscribeState:function(){function e(){var e=[];return n.each(function(){e.push(this.getAttribute("data-event-id"))}),e.join(",")}function i(e){n.each(function(i,n){var a=$(n);a.hasClass("isLive")||(t.currState=1==e[i].bSubscribe?t.assignSub:t.cancelSub,t.currState.btnStatus(a))})}if(!this.yyUid)return!1;var t=this,n=this.$elementId.find(".preview-item"),a=e();this.getData(this.ajaxObj.stateUrl,{event_ids:a,uid:this.yyUid},function(e){0==e.code&&e.data&&e.data.length>0&&i(e.data)})},bindEvent:function(){var e=this;this.$elementId.on("mouseenter",".preview-item",function(){var e=$(this);e.hasClass("on")||e.addClass("on").siblings().removeClass("on")}),this.$elementId.on("click",".preview-btn",function(){var i=$(this);NAV_UTIL.checkLogin(function(){var t=i.parents(".preview-item");if(t.hasClass("isLive"))return!1;var n=i.data("eventId"),a=t.hasClass("normal")?1:0;1==a?e.currState=e.assignSub:0==a&&(e.currState=e.cancelSub),e.currState.change(n,i)})}),$(".preview-list").on("mousemove",".preview-item",function(i){if(!($(this).find(".preview-digest-textarea").length<1)){var t=$(this).find(".preview-digest-textarea").val();e.digest.show($(this),t,i)}}).on("mouseleave",".preview-item",function(){e.digest.hide()}),$(".preview-list").on("mousemove",".preview-btn",function(){return e.digest.hide(),!1})},digest:{view:null,show:function(e,i,t){this.view||(this.view=$('<div class="preview-digest" id="js-preview-digest"><h2 class="preview-digest-title">\u8282\u76ee\u7b80\u4ecb</h2><p class="preview-digest-content"></p></div>').appendTo("body")),this.view.find(".preview-digest-content").text(i),this.tip(e,i,t)},tip:function(e,i,t){var n=10,a=10,s=$("#js-preview-digest").outerWidth(),r=$("#js-preview-digest").outerHeight(),o=t.pageX+n,l=t.pageY+a;o>$(document).width()-s-21&&(o=$(document).width()-s-21),l>$(document).height()-r&&(l=$(document).height()-r),this.view.css({left:o,top:l}).show()},hide:function(){this.view&&this.view.hide()}},getData:function(e,i,t){$.ajax({url:e,type:"GET",dataType:"jsonp",data:i}).done(function(e){t&&t(e)})},destroy:function(){this.jScrollPaneElement&&this.jScrollPaneElement.data("jsp").destroy(),this.$elementId.off(),window.DUYA_SUB&&DUYA_SUB.unsubscribe("INDEX_LIVE_NOTICE")}};var $jsPreviewBox=$("#js-preview-box"),$win=$(window);$jsPreviewBox.find("img").lazyload(),$win.on("scroll.js-preview-box",function(){triggerLazyload()}),triggerLazyload()});
;dwfis.define("widget/index-star-box/start.js",function(){function e(){if(i.scrollTop()>=500){if(t.find("img").trigger("appear"),$.isFunction($.fn.jScrollPane))t.jScrollPane({mouseWheelSpeed:20,verticalGutter:0,isOutsideNotPrevent:!1});else{var e="//a.msstatic.com/huya/main/lib/scrollpane_51f7a10.js";$.ajax(e,{dataType:"script",cache:!0,success:function(){t.jScrollPane({mouseWheelSpeed:20,verticalGutter:0,isOutsideNotPrevent:!1})}})}i.off(".star-list")}}var t=$(".star-list"),i=$(window);t.find("img").lazyload(),i.on("scroll.star-list",function(){e()}),e()});
;dwfis.define("app/index",function(e){var t=(e("widget/backtotop"),e("tools"));$(window).on("focus",function(){var e=function(e){return-1!=navigator.appName.indexOf("Microsoft")?window[e]:document[e]};try{e("index_player").callAs("changeTabTarget")}catch(t){}});var d=e("exposureReport"),i=new d;e("widget/index-game-classify/video-preview.js"),$(".box-placeholder").html($(".data-placeholder").html()),e("widget/index-program-preview"),e("widget/index-star-box/start.js"),$(".nav-recommend img").lazyload({threshold:200}),$(".live-box img").lazyload({threshold:500}),$(".mod-actlist__bd img").lazyload({threshold:200}),setTimeout(function(){$(".box-placeholder").show()},0),i.reportData(slides,"index/jdt"),$.each(slides,function(e,t){TT_RSC_EXPS({pos:"index/jdt/"+e,ren:t.uid})}),$.each(blogAd,function(e,t){t&&TT_RSC_EXPS({pos:"index/news/pic/"+e,rsc:t.id})}),t.exposure(document.getElementById("J_bnM"),function(){var e=Math.floor((new Date).getTime()/1e3),d="http://ad.doubleclick.net/ddm/trackimp/N5751.3159.GOOGLE/B20134077.202466803;dc_trk_aid=402314954;dc_trk_cid=91171470;ord="+e+"?http://v.admaster.com.cn/i/a89327,b1851435,c3043,i0,m202,8a2,8b2,0k10038,h",i=t.loadImg(d,function(){i=null})}),t.exposure(document.getElementById("J_recImg"),function(){var e=Math.floor((new Date).getTime()/1e3),d="http://ad.doubleclick.net/ddm/trackimp/N5751.3159.GOOGLE/B20134077.202497381;dc_trk_aid=402342708;dc_trk_cid=91171470;ord="+e+"?http://v.admaster.com.cn/i/a89327,b1851435,c3043,i0,m202,8a2,8b2,0k10038,h",i=t.loadImg(d,function(){i=null})});var a=["J_adLeft","J_adBnM","J_thirdView_1","J_thirdView_2","J_thirdView_3","J_thirdView_4","J_thirdView_5"];$.each(a,function(e,d){t.exposure(document.getElementById(d),function(e){function d(){return"undefined"==typeof ya?void(o=setTimeout(function(){d()},1e3)):(clearTimeout(o),void ya.reportProductEvent({eid:e.attr("eid").replace("click","preview"),eid_desc:e.attr("eid_desc").replace("\u70b9\u51fb","\u66dd\u5149"),ref:YA.cookie.get("ya_eid")}))}if(e.data("thirdview")&&"undefined"!=e.data("thirdview"))var i=e.data("thirdview"),a=t.loadImg(i,function(){a=null});var o;d()})})});